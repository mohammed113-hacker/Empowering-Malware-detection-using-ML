# Empowering-Advanced-Malware-detection-using-ML

### Libraries Used

***Numpy,
Pandas,
Matplotlib,
Sklearn,
Pefile,
Streamlit,
Flask,
Pickle,
Joblib***

https://github.com/user-attachments/assets/7b426a31-c7c1-4464-8ade-c150243a081a


## Introduction:

Malware continues to pose a significant threat to computer systems, making effective detection crucial for safeguarding digital environments. This project presents an innovative approach to empowering malware detection through the application of machine learning techniques. The focus lies on training four distinct machine learning models using a dataset comprising Portable Executable (PE) header values from two classes: legitimate and malware files. The project 
workflow involves preprocessing the dataset, extracting relevant features from PE headers, selecting appropriate machine learning models, training and evaluating these models,and finally deploying them within a web server environment. Upon deployment, the system enables real-time malware detection by extracting PE header values from executable (exe) or dynamic-link library (dll) files uploaded to the web interface and feeding them into the trained machine learning models.

## Proposed Unique Approach

![dissected_exe_for_paper](https://github.com/user-attachments/assets/98dd2228-adbd-40c6-ad1b-ae6ee4b43925)

The Portable Executable (PE) header of an Executable (EXE) file serves as a rich source of metadata that encapsulates crucial information about the file's structure, functionality, and behavior. PE header values, such as file attributes, machine architecture, sizes of different sections, entry point address, version information, and many others offer a comprehensive view of the executable's properties. These attributes can be indicative of malicious behavior, such as obfuscation techniques, packer usage, or anomaly in section sizes, which can be leveraged by machine learning algorithms to differentiate between legitimate and malicious EXE files. Through
extensive exploration of feature extraction methods, the project seeks to capture unique  malware attributes within the PE header values and train different machine learning model with those attributes. Ultimately, the trained models will be deployed within a web-based architecture to facilitate real-time malware detection.

## Dataset Visulaization (malware_dataset.py)

![Dataset_detail](https://github.com/user-attachments/assets/e8df8348-1854-4fab-81da-ca199c7a2eef)

With the help of python libraries like NumPy, Pandas and Matplotlib I analyzed 
the dataset and plotted it as pie chart and find out that it contains 70.1% malwares 
and 29.9% benign files data samples.

## Feature Selection (malware_dataset.py)

![features-impotance plotting](https://github.com/user-attachments/assets/54d98840-4c96-43b6-b3a0-0ed9107d61d7)

The features are selected by using a python library called sklearn which contains special function to select important features in the dataset, with the help of feature_importances_ function. I select top 13 features in the dataset to train the ML models. The feature_importances_ function is a valuable tool in machine learning for identifying important features that contribute significantly to the predictive performance of a model. When it was applied, the feature_importances_ function calculates a score for each feature based on its contribution to the model's decision-making process. Features with higher scores are considered more important, as they have a greater impact on the model's predictions.

## Model Selection (malware_dataset.py)

A careful consideration was given to identifying the most suitable machine learning algorithms for the task of malware detection based on the characteristics of the dataset and the nature of the problem. Four distinct models were chosen decision trees, random forest, gradient boosting, and XGBoost classifier.

## Model Training and Testing (malware_dataset.py)

The dataset was split into 80% for training and 20% for testing purpose, This was done by using a  special function called train_test_split() in sklearn library . During the model training phase, the selected machine learning algorithms were trained on the selected input features comprising PE header attributes of both malware and benign files. Each model underwent an 
extensive training process, during which it learned to distinguish between the characteristic patterns exhibited by legitimate software and those indicative of malicious behavior. I then separately evaluate these models with some parameters like Accuracy, Precision, Recall, Support.

## Deployment On a Web Server (app.py)

![web-architecture-overview](https://github.com/user-attachments/assets/3caa348f-108c-4637-8f3b-d788b63fb2c6)

This deployment aims to provide a convenient and user-friendly web interface, enabling users to seamlessly interact with the system for malware detection purposes. users can upload their EXE applications with ease, initiating a behind the-scenes process that automates the extraction of selected features (PE_extraxt.py) from the uploaded files PE headers. I used **Flask application** for this purpose and trigger **streamlit library** for web page to dynamically upload the files.

Upon uploading an EXE file, the system utilizes the **‘pefile’ library to parse and extract the features from the file's PE header**. These extracted features are then organized into a structured format and fed into the trained machine learning model for analysis and prediction. The system evaluates the feature vector and determines whether the uploaded file exhibits characteristics indicative of malicious behavior.

The deployment of this malware detection system on a dedicated server not only ensures **scalability and reliability but also facilitates real-time analysis and response to user requests**. By providing an accessible web interface, my aim is to democratize the process of malware detection, empowering users with the tools and insights needed to assess the security of their executable files effectively.

## Working and Operation

![front-page-website](https://github.com/user-attachments/assets/b8f52a92-dfeb-4dd5-b6b3-fdd7772c4a48)

![legitimate-file-features](https://github.com/user-attachments/assets/eb050634-70e2-4fdb-bee0-bf045be5fc2f)

![prediction-page](https://github.com/user-attachments/assets/9cb5f4d1-99df-4c14-924c-124c5a288988)

## Conclusion

The development of our malware detection system, leveraging machine learning techniques and PE header feature extraction, marks a significant step forward in enhancing cybersecurity measures against the proliferation of malicious executable files. Through rigorous experimentation and evaluation, we have demonstrated the efficacy of our approach in accurately identifying and distinguishing between legitimate and malicious EXE files. The deployment of the well-trained machine learning model on a dedicated server, coupled with a user-friendly web interface, underscores our commitment to providing accessible and effective solutions for malware detection. 


I also tried to implement malicious url detection with a concept of whitelisting and blacklisting, Unfortunately i couldn't able to complete it. I am looking for contributers who can contribute their work for this. Try your Best!. Good Luck.
